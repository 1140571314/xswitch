!function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=(e,t)=>{if(/\\|\[|]|\(|\)|\*|\$|\^/i.test(t)){if(new RegExp(t.replace("??","\\?\\?"),"i").test(e))return"reg"}else{if(e.indexOf(t)>-1)return"string"}return!1};t.default=new class{constructor(){this._lastRequestId=null,this._disabled="enabled",this._config={},this._originRequest=new Map,this._originRequestHeaders=new Map,this.urls=new Array(200)}get disabled(){return this._disabled}set disabled(e){this._disabled=e}get config(){return this._config}set config(e){this._config=Object.assign({},e)}onHeadersReceivedCallback(e,t=!0){let r=this.config.cors,n=!1;if(r&&r.length&&r.forEach(t=>{s(e.url,t)&&(n=!0)}),"disabled"==this.disabled||!t||!n)return{};e.url;let o=[],i=(this._originRequest.get(e.requestId)?this._originRequest.get(e.requestId):e.initiator)||"*";if(e.responseHeaders&&e.responseHeaders.filter){let t=!1,r="";o=e.responseHeaders.filter(e=>("access-control-allow-origin"===e.name.toLowerCase()&&(r=e.value),"access-control-allow-credentials"===e.name.toLowerCase()&&(t=e.value),["access-control-allow-origin","access-control-allow-credentials","access-control-allow-methods","access-control-allow-headers"].indexOf(e.name.toLowerCase())<0)),t&&(i=r)}"*"===i&&"null"===this._originRequest.get(e.requestId)&&(i="*"),o.push({name:"Access-Control-Allow-Origin",value:i}),o.push({name:"Access-Control-Allow-Credentials",value:"true"}),o.push({name:"Access-Control-Allow-Methods",value:"*"});let l=this._originRequestHeaders.get(e.requestId)?","+this._originRequestHeaders.get(e.requestId):"";return o.push({name:"Access-Control-Allow-Headers",value:"Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With, X-Referer"+l}),{responseHeaders:o}}redirectToMatchingRule(e){const t=this.config.proxy;let r=e.url;if(!t||!t.length||/^chrome-extension:\/\//i.test(r))return{};/http(s?):\/\/.*\.(js|css|json|jsonp)/.test(r)&&this.urls.indexOf(r)<0&&(this.urls.shift(),this.urls.push(r));try{for(let n=0;n<t.length;n++){const o=t[n];if(o&&o[0]&&"string"==typeof o[1]){let t=o[0],n=s(r,t);if(e.requestId!==this._lastRequestId)if("reg"===n){let e=new RegExp(t.replace("??","\\?\\?"),"i");r=r.replace(e,o[1])}else"string"===n&&(r=r.split(o[0]).join(o[1]))}}}catch(e){console.error("rule match error",e)}return this._lastRequestId=e.requestId,r===e.url?{}:{redirectUrl:r}}onBeforeSendHeadersCallback(e){let t=[];for(var r=0;r<e.requestHeaders.length;++r){const s=e.requestHeaders[r].name.toLowerCase();"origin"===s?this._originRequest.set(e.requestId,e.requestHeaders[r].value):("access-control-request-headers"===s||/^x-/.test(s))&&t.push(s)}return t.length&&this._originRequestHeaders.set(e.requestId,t.join(",")),{requestHeaders:e.requestHeaders}}onBeforeRequestCallback(e){return this.redirectToMatchingRule(e)}}}]);