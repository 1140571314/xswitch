!function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}({0:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=(e,t)=>{if(/\\|\[|]|\(|\)|\*|\$|\^/i.test(t)){if(new RegExp(t.replace("??","\\?\\?"),"i").test(e))return"reg"}else{if(e.indexOf(t)>-1)return"string"}return!1};t.default=new class{constructor(){this._lastRequestId=null,this._disabled="enabled",this._config={},this._originRequest=new Map,this._originRequestHeaders=new Map,this.urls=new Array(200)}get disabled(){return this._disabled}set disabled(e){this._disabled=e}get config(){return this._config}set config(e){this._config=Object.assign({},e)}onHeadersReceivedCallback(e,t=!0){let r=this.config.cors,n=!1;if(r&&r.length&&r.forEach(t=>{s(e.url,t)&&(n=!0)}),"disabled"==this.disabled||!t||!n)return{};e.url;let o=[],l=(this._originRequest.get(e.requestId)?this._originRequest.get(e.requestId):e.initiator)||"*";if(e.responseHeaders&&e.responseHeaders.filter){let t=!1,r="";o=e.responseHeaders.filter(e=>("access-control-allow-origin"===e.name.toLowerCase()&&(r=e.value),"access-control-allow-credentials"===e.name.toLowerCase()&&(t=e.value),["access-control-allow-origin","access-control-allow-credentials","access-control-allow-methods","access-control-allow-headers"].indexOf(e.name.toLowerCase())<0)),t&&(l=r)}"*"===l&&"null"===this._originRequest.get(e.requestId)&&(l="*"),o.push({name:"Access-Control-Allow-Origin",value:l}),o.push({name:"Access-Control-Allow-Credentials",value:"true"}),o.push({name:"Access-Control-Allow-Methods",value:"*"});let a=this._originRequestHeaders.get(e.requestId)?","+this._originRequestHeaders.get(e.requestId):"";return o.push({name:"Access-Control-Allow-Headers",value:"Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With, X-Referer"+a}),{responseHeaders:o}}redirectToMatchingRule(e){const t=this.config.proxy;let r=e.url;if(!t||!t.length||/^chrome-extension:\/\//i.test(r))return{};/http(s?):\/\/.*\.(js|css|json|jsonp)/.test(r)&&this.urls.indexOf(r)<0&&(this.urls.shift(),this.urls.push(r));try{for(let n=0;n<t.length;n++){const o=t[n];if(o&&o[0]&&"string"==typeof o[1]){let t=o[0],n=s(r,t);if(e.requestId!==this._lastRequestId)if("reg"===n){let e=new RegExp(t.replace("??","\\?\\?"),"i");r=r.replace(e,o[1])}else"string"===n&&(r=r.split(o[0]).join(o[1]))}}}catch(e){console.error("rule match error",e)}return this._lastRequestId=e.requestId,r===e.url?{}:{redirectUrl:r}}onBeforeSendHeadersCallback(e){let t=[];for(var r=0;r<e.requestHeaders.length;++r){const s=e.requestHeaders[r].name.toLowerCase();"origin"===s?this._originRequest.set(e.requestId,e.requestHeaders[r].value):("access-control-request-headers"===s||/^x-/.test(s))&&t.push(s)}return t.length&&this._originRequestHeaders.set(e.requestId,t.join(",")),{requestHeaders:e.requestHeaders}}onBeforeRequestCallback(e){return this.redirectToMatchingRule(e)}}},5:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);let n=!1,o=!0,l=!0,a=!1;function i(){let e=0;const{browserAction:t}=chrome;return e=s.default.config.proxy.length,a?(t.setBadgeText({text:"Error"}),void t.setBadgeBackgroundColor({color:"#c53929"})):"disabled"===s.default.disabled?(t.setBadgeText({text:"OFF"}),void t.setBadgeBackgroundColor({color:"#bfbfbf"})):(t.setBadgeText({text:""+e}),void t.setBadgeBackgroundColor({color:"#3367d6"}))}chrome.storage.sync.get("config",e=>{try{s.default.config=JSON.parse(e.config),a=!1}catch(t){console.warn("can not parse config",e.config),s.default.config.proxy=[],a=!0}}),chrome.storage.onChanged.addListener(e=>{if(e.config)try{s.default.config=JSON.parse(e.config.newValue),a=!1}catch(t){console.warn("can not parse fresh config",e.config.newValue),s.default.config.proxy=[],a=!0}e.disabled&&(s.default.disabled=e.disabled.newValue),e.clearCacheEnabled&&(o="enabled"===e.clearCacheEnabled.newValue),e.corsEnabled&&(l="enabled"===e.corsEnabled.newValue),i()}),chrome.storage.sync.get({disabled:"enabled",clearCacheEnabled:"enabled",corsEnabled:"enabled"},e=>{s.default.disabled=e.disabled,o="enabled"===e.clearCacheEnabled,l="enabled"===e.corsEnabled,i()}),chrome.webRequest.onBeforeRequest.addListener(e=>"disabled"!==s.default.disabled?(o&&function(){if(!n){n=!0;const e=6048e5,t=(new Date).getTime()-e;chrome.browsingData.removeCache({since:t},()=>{n=!1})}}(),s.default.onBeforeRequestCallback(e)):{},{urls:["<all_urls>"]},["blocking"]),chrome.webRequest.onHeadersReceived.addListener(function(e){return s.default.onHeadersReceivedCallback(e,l)},{urls:["<all_urls>"]},["blocking","responseHeaders"]),chrome.webRequest.onBeforeSendHeaders.addListener(e=>s.default.onBeforeSendHeadersCallback(e),{urls:["<all_urls>"]},["blocking","requestHeaders"])}});